#!/usr/bin/env bash

bin=$(dirname ${BASH_SOURCE[0]})
bin=$(cd "$bin"; pwd)

. "$bin"/{{project__name}}-config.sh

gconf="$GUNIFLASK_APP_CONF_DIR"/startup.py

echo "stop {{project_name}}"

target_pid=$("$PYTHON" "$bin"/catpid.py "$gconf")

if kill -0 $target_pid > /dev/null 2>&1; then
    echo "kill $target_pid"
    kill $target_pid
    sleep 3
    if kill -0 $target_pid > /dev/null 2>&1; then
        echo "{{project_name}} did not stop gracefully after 3 seconds"
    else
        echo "{{project_name}} stopped"
    fi
else
    echo "no {{project_name}} to stop"
fi
